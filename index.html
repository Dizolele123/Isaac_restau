<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>üíç Mariage - Gestion des Pr√©sences | 22 F√©vrier 2025</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --gold: #C5A059;
            --gold-light: #E5D3B0;
            --gold-pale: #F8F0E0;
            --ivory: #FFF9F0;
            --cream: #FDF5E6;
            --charcoal: #2C2C2C;
            --taupe: #8A7F7A;
            --white: #FFFFFF;
            --shadow: rgba(197, 160, 89, 0.15);
            --success: #10b981;
            --success-light: #d1fae5;
            --warning: #f59e0b;
            --warning-light: #fef3c7;
            --danger: #ef4444;
            --danger-light: #fee2e2;
            --info: #3b82f6;
            --info-light: #dbeafe;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--cream);
            color: var(--charcoal);
            line-height: 1.6;
            scroll-behavior: smooth;
        }
        
        .heading-font {
            font-family: 'Cormorant Garamond', serif;
            letter-spacing: 1px;
        }
        
        .gold-gradient {
            background: linear-gradient(145deg, var(--gold-light) 0%, var(--gold) 100%);
        }
        
        .gold-text {
            color: var(--gold);
        }
        
        .btn-gold {
            background-color: var(--gold);
            color: white;
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        
        .btn-gold:hover {
            background-color: #B38B4A;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(197, 160, 89, 0.4);
        }
        
        .section-title {
            position: relative;
            padding-bottom: 20px;
            margin-bottom: 50px;
            font-size: 2.5rem;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }
        
        /* Statuts des invit√©s */
        .status-badge {
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .status-present {
            background-color: var(--success-light);
            color: #047857;
            border: 1px solid #10b981;
        }
        
        .status-absent {
            background-color: var(--warning-light);
            color: #b45309;
            border: 1px solid #f59e0b;
        }
        
        .status-entered {
            background-color: var(--info-light);
            color: #1e40af;
            border: 1px solid #3b82f6;
        }
        
        /* Cartes de statistiques */
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 10px 30px var(--shadow);
            transition: all 0.3s ease;
            border: 1px solid var(--gold-light);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), var(--gold-light));
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px var(--shadow);
        }
        
        .stat-number {
            font-size: 3rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 8px;
        }
        
        /* Timeline */
        .entry-timeline {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        .entry-timeline::-webkit-scrollbar {
            width: 6px;
        }
        
        .entry-timeline::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .entry-timeline::-webkit-scrollbar-thumb {
            background: var(--gold);
            border-radius: 10px;
        }
        
        .timeline-item {
            padding: 12px;
            border-left: 3px solid var(--gold);
            margin-bottom: 12px;
            background: white;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.65)), url('i1.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        .image-frame {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        .image-frame img {
            transition: transform 0.8s ease;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-frame:hover img {
            transform: scale(1.1);
        }
        
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }
        
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .auth-modal {
            background: rgba(44, 44, 44, 0.95);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="antialiased">

    <!-- MODAL D'AUTHENTIFICATION -->
    <div id="authModal" class="auth-modal hidden fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-md w-full p-8 relative">
            <div class="absolute -top-6 left-1/2 transform -translate-x-1/2">
                <div class="w-16 h-16 gold-gradient rounded-full flex items-center justify-center shadow-lg">
                    <i class="fas fa-lock text-white text-2xl"></i>
                </div>
            </div>
            
            <div class="text-center mt-6 mb-8">
                <h3 class="heading-font text-3xl font-bold text-gray-800 mb-2">Acc√®s Organisateurs</h3>
                <p class="text-gray-500">Gestion des pr√©sences</p>
                <div class="w-16 h-0.5 bg-gradient-to-r from-transparent via-gold to-transparent mx-auto mt-4"></div>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-user text-gold mr-2"></i>Identifiant
                    </label>
                    <input type="text" id="username" 
                           class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gold"
                           placeholder="Entrez votre identifiant"
                           required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-lock text-gold mr-2"></i>Mot de passe
                    </label>
                    <input type="password" id="password" 
                           class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gold"
                           placeholder="Entrez votre mot de passe"
                           required>
                </div>
                
                <div id="loginError" class="hidden bg-red-50 border border-red-200 rounded-lg p-4 text-red-600 text-sm">
                    <i class="fas fa-exclamation-circle mr-2"></i>
                    <span id="errorMessageText">Identifiants incorrects</span>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-4 pt-4">
                    <button type="submit" class="btn-gold flex-1 px-6 py-3 rounded-lg font-semibold">
                        <i class="fas fa-sign-in-alt mr-2"></i>Se connecter
                    </button>
                    <button type="button" id="cancelLogin" 
                            class="flex-1 px-6 py-3 border-2 border-gray-200 rounded-lg font-semibold text-gray-600 hover:border-gray-300">
                        Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- NAVIGATION -->
    <nav class="fixed top-0 left-0 w-full z-50 bg-white/95 backdrop-blur-sm shadow-sm">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <a href="#accueil" class="flex items-center space-x-3 group">
                    <div class="w-10 h-10 gold-gradient rounded-full flex items-center justify-center transform group-hover:scale-110 transition">
                        <i class="fas fa-heart text-white text-sm"></i>
                    </div>
                    <span class="heading-font text-xl font-bold">
                        <span class="gold-text">Mariage</span>
                        <span class="text-gray-800">2025</span>
                    </span>
                </a>
                
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#accueil" class="text-gray-600 hover:text-gold transition font-medium">Accueil</a>
                    <a href="#programme" class="text-gray-600 hover:text-gold transition font-medium">Programme</a>
                    <a href="#galerie" class="text-gray-600 hover:text-gold transition font-medium">Galerie</a>
                    <a href="#invites" class="text-gray-600 hover:text-gold transition font-medium">Pr√©sences</a>
                    <button id="adminAccessBtn" class="btn-gold px-5 py-2 rounded-full text-sm font-semibold">
                        <i class="fas fa-user-shield mr-2"></i>Organisateurs
                    </button>
                </div>
                
                <button id="menu-toggle" class="md:hidden text-2xl text-gray-600">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <div id="mobile-menu" class="hidden md:hidden mt-4 bg-white rounded-lg shadow-lg p-4">
                <div class="flex flex-col space-y-3">
                    <a href="#accueil" class="py-2 px-4 text-gray-600 hover:bg-gold-pale rounded-lg">Accueil</a>
                    <a href="#programme" class="py-2 px-4 text-gray-600 hover:bg-gold-pale rounded-lg">Programme</a>
                    <a href="#galerie" class="py-2 px-4 text-gray-600 hover:bg-gold-pale rounded-lg">Galerie</a>
                    <a href="#invites" class="py-2 px-4 text-gray-600 hover:bg-gold-pale rounded-lg">Pr√©sences</a>
                    <button id="adminAccessBtnMobile" class="btn-gold px-4 py-2 rounded-lg text-white font-medium">
                        <i class="fas fa-user-shield mr-2"></i>Acc√®s Organisateurs
                    </button>
                </div>
            </div>
        </div>
    </nav>
    <div class="h-20"></div>

    <!-- HERO SECTION -->
    <section id="accueil" class="hero-section relative min-h-screen flex items-center justify-center">
        <div class="container mx-auto px-6 py-24 text-center relative z-10">
            <div class="max-w-4xl mx-auto fade-in-up">
                <div class="inline-block px-6 py-2 bg-white/10 backdrop-blur-sm rounded-full border border-white/20 mb-8">
                    <span class="text-gold-light tracking-wider">‚ú¶ 22 F√âVRIER 2025 ‚ú¶</span>
                </div>
                
                <h1 class="heading-font text-6xl md:text-7xl lg:text-8xl font-bold mb-6 leading-tight">
                    C√©l√©brons
                    <span class="block gold-text">l'Amour</span>
                </h1>
                
                <div class="w-24 h-1 bg-gold mx-auto mb-8"></div>
                
                <p class="text-xl md:text-2xl text-gray-200 mb-12 font-light">
                    Le mariage de Suadrick Fharguet et  Deo-Gracias
                </p>
            </div>
        </div>
    </section>

    <!-- SECTION PROGRAMME (avec vos photos) -->
    <section id="programme" class="py-24 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="section-title heading-font text-center reveal">
                <span>Programme des ceremonies </span>
            </h2>
            
            <div class="max-w-5xl mx-auto mt-16">
                <!-- √âv√©nement 1 - C√©r√©monie -->
                <div class="flex flex-col md:flex-row items-center gap-8 mb-16 reveal">
                    <div class="md:w-1/2 md:text-right order-2 md:order-1">
                        <div class="inline-block px-4 py-1 bg-gold-pale rounded-full text-gold text-sm mb-3">
                            <i class="fas fa-clock mr-1"></i> 9h00 - 11h30
                        </div>
                        <h3 class="heading-font text-3xl font-bold mb-4">Mariage Civil</h3>
                        <p class="text-gray-600 mb-4">Un moment solennel et √©mouvant.</p>
                        <div class="flex items-center justify-end gap-2 text-gold">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Mairie de M'filou</span>
                        </div>
                    </div>
                    <div class="md:w-1/2 order-1 md:order-2">
                        <div class="image-frame aspect-[4/3]">
                            <img src="i1.jpg" alt="C√©r√©monie">
                        </div>
                    </div>
                </div>
                
                <!-- √âv√©nement 2 - Cocktail -->
                <div class="flex flex-col md:flex-row items-center gap-8 mb-16 reveal">
                    <div class="md:w-1/2">
                        <div class="image-frame aspect-[4/3]">
                            <img src="i2.jpg" alt="Cocktail">
                        </div>
                    </div>
                    <div class="md:w-1/2 md:pl-12">
                        <div class="inline-block px-4 py-1 bg-gold-pale rounded-full text-gold text-sm mb-3">
                            <i class="fas fa-clock mr-1"></i> 12h30 - 14h30
                        </div>
                        <h3 class="heading-font text-3xl font-bold mb-4">Benediction Nuptiale</h3>
                        <p class="text-gray-600 mb-4">Moment de partage et de convivialit√©.</p>
                        <div class="flex items-center gap-2 text-gold">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Eglise EBNM KCC, Moukondo Rue Tankana</span>
                        </div>
                    </div>
                </div>
                
                <!-- √âv√©nement 3 - D√Æner -->
                <div class="flex flex-col md:flex-row items-center gap-8 reveal">
                    <div class="md:w-1/2 md:text-right order-2 md:order-1">
                        <div class="inline-block px-4 py-1 bg-gold-pale rounded-full text-gold text-sm mb-3">
                            <i class="fas fa-clock mr-1"></i> 18h00 - 21h00
                        </div>
                        <h3 class="heading-font text-3xl font-bold mb-4">D√Æner</h3>
                        <p class="text-gray-600 mb-4">D√Æner raffin√© .</p>
                        <div class="flex items-center justify-end gap-2 text-gold">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Espace SONY LABOUTANSSY</span>
                        </div>
                    </div>
                    <div class="md:w-1/2 order-1 md:order-2">
                        <div class="image-frame aspect-[4/3]">
                            <img src="i1.jpg" alt="Soir√©e">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- √Ä ajouter √† la fin de la section programme, apr√®s la timeline -->
<div class="text-center mt-16 reveal">
    <div class="inline-flex flex-col sm:flex-row gap-4">
        <a href="programme-mariage.docx" 
           download="programme-mariage.docx"
           class="btn-gold px-8 py-4 rounded-full font-semibold inline-flex items-center justify-center">
            <i class="fas fa-download mr-2"></i>
            T√©l√©charger le programme (PDF)
        </a>
        <button onclick="window.print()" 
                class="btn-outline-gold px-8 py-4 rounded-full font-semibold inline-flex items-center justify-center">
            <i class="fas fa-print mr-2"></i>
            Imprimer le programme
        </button>
    </div>
    <p class="text-sm text-gray-400 mt-4">
        <i class="fas fa-info-circle mr-1"></i>
        Programme d√©taill√© de la soir√©e disponible en t√©l√©chargement
    </p>
</div>
    </section>

    <!-- SECTION GALERIE -->
    <section id="galerie" class="py-24 bg-ivory">
        <div class="container mx-auto px-6">
            <h2 class="section-title heading-font text-center reveal">
                <span>Galerie Souvenir</span>
            </h2>
            
            <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <div class="group relative reveal">
                    <div class="image-frame aspect-square">
                        <img src="i1.jpg" alt="Photo 1">
                    </div>
                </div>
                <div class="group relative reveal">
                    <div class="image-frame aspect-square">
                        <img src="i2.jpg" alt="Photo 2">
                    </div>
                </div>
                <div class="group relative reveal md:col-span-2 max-w-2xl mx-auto">
                    <div class="image-frame aspect-video">
                        <img src="i1.jpg" alt="Photo 3">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION GESTION DES PR√âSENCES (NOUVELLE VERSION) -->
    <section id="invites" class="py-24 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="section-title heading-font text-center reveal">
                <span>Gestion des Pr√©sences</span>
            </h2>
            
            <!-- Message public (non authentifi√©) -->
            <div id="guestMessage" class="max-w-3xl mx-auto reveal">
                <div class="bg-gradient-to-br from-gold-pale to-cream rounded-3xl p-12 text-center shadow-lg">
                    <div class="w-24 h-24 bg-white rounded-full flex items-center justify-center mx-auto mb-8 shadow-lg">
                        <i class="fas fa-users text-4xl gold-text"></i>
                    </div>
                    <h3 class="heading-font text-3xl font-bold mb-4">Espace Organisateurs</h3>
                    <p class="text-lg text-gray-700 mb-8">
                        Acc√®s r√©serv√© √† l'√©quipe d'organisation pour la gestion des entr√©es.
                    </p>
                    <button id="accessVerificationBtn" class="btn-gold px-8 py-4 rounded-full font-semibold">
                        <i class="fas fa-user-shield mr-2"></i>
                        Acc√®s organisateurs
                    </button>
                </div>
            </div>
            
            <!-- Interface de gestion des pr√©sences (authentifi√©) -->
            <div id="verificationInterface" class="hidden max-w-6xl mx-auto">
                <!-- En-t√™te avec stats et d√©connexion -->
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8 reveal">
                    <div>
                        <h3 class="heading-font text-3xl font-bold mb-2">Tableau de bord des pr√©sences</h3>
                        <p class="text-gray-500">G√©rez les entr√©es en temps r√©el</p>
                    </div>
                    <button id="logoutBtn" class="px-6 py-3 bg-red-50 text-red-600 rounded-full hover:bg-red-100 transition">
                        <i class="fas fa-sign-out-alt mr-2"></i>
                        D√©connexion
                    </button>
                </div>
                
                <!-- Cartes de statistiques (NOUVEAU) -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8 reveal">
                    <!-- Total invit√©s -->
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm font-medium text-gray-500">Total invit√©s</span>
                            <div class="w-10 h-10 bg-gold-pale rounded-full flex items-center justify-center">
                                <i class="fas fa-users gold-text"></i>
                            </div>
                        </div>
                        <div class="stat-number gold-text" id="totalGuests">0</div>
                        <div class="text-sm text-gray-400">Inscrits sur la liste</div>
                    </div>
                    
                    <!-- D√©j√† entr√©s -->
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm font-medium text-gray-500">D√©j√† entr√©s</span>
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-600"></i>
                            </div>
                        </div>
                        <div class="stat-number text-green-600" id="enteredGuests">0</div>
                        <div class="text-sm text-gray-400">Dans la salle</div>
                    </div>
                    
                    <!-- Pas encore entr√©s -->
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm font-medium text-gray-500">Pas encore entr√©s</span>
                            <div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-hourglass-half text-yellow-600"></i>
                            </div>
                        </div>
                        <div class="stat-number text-yellow-600" id="pendingGuests">0</div>
                        <div class="text-sm text-gray-400">En attente</div>
                    </div>
                    
                    <!-- Places restantes -->
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm font-medium text-gray-500">Taux de pr√©sence</span>
                            <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-chart-pie text-blue-600"></i>
                            </div>
                        </div>
                        <div class="stat-number text-blue-600" id="presenceRate">0%</div>
                        <div class="text-sm text-gray-400">Compl√©tude</div>
                    </div>
                </div>
                <!-- √Ä ajouter dans verificationInterface, apr√®s les cartes de statistiques -->
<div class="flex flex-wrap justify-center gap-4 mb-8 reveal">
    <!-- Bouton t√©l√©charger le programme (pour les organisateurs aussi) -->
    <a href="programme-mariage.docx" 
       download="programme-mariage.docx"
       class="btn-gold px-6 py-3 rounded-xl font-semibold inline-flex items-center">
        <i class="fas fa-download mr-2"></i>
        Programme (Word)
    </a>
    
    <!-- Bouton g√©n√©rer et t√©l√©charger la liste des invit√©s -->
    <button id="downloadGuestListBtn" 
            class="btn-gold px-6 py-3 rounded-xl font-semibold inline-flex items-center"
            onclick="generateAndDownloadGuestList()">
        <i class="fas fa-file-word mr-2"></i>
        Liste des invit√©s (Word)
    </button>
    
    <!-- Bouton exporter en Excel (optionnel) -->
    <button id="exportExcelBtn" 
            class="btn-outline-gold px-6 py-3 rounded-xl font-semibold inline-flex items-center">
        <i class="fas fa-file-excel mr-2"></i>
        Exporter en Excel
    </button>
</div>
                
                <!-- Barre de recherche am√©lior√©e -->
                <div class="bg-gradient-to-br from-white to-cream rounded-2xl p-6 shadow-lg mb-8 reveal">
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex-grow relative">
                            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                            <input type="text" id="searchInput" 
                                   placeholder="Rechercher un invit√© par nom ou pr√©nom..." 
                                   class="w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-gold">
                        </div>
                        <button id="searchButton" class="btn-gold px-8 py-4 rounded-xl font-semibold whitespace-nowrap">
                            <i class="fas fa-search mr-2"></i>
                            Rechercher
                        </button>
                    </div>
                </div>
                
                <!-- R√©sultat de recherche (avec bouton d'entr√©e) -->
                <div id="searchResult" class="hidden mb-8 reveal"></div>
                
                <!-- Message d'erreur -->
                <div id="errorMessage" class="hidden p-6 bg-red-50 border border-red-200 rounded-2xl text-red-700 text-center mb-8 reveal">
                    <i class="fas fa-exclamation-circle text-3xl mb-3"></i>
                    <p id="errorText" class="text-lg font-medium"></p>
                </div>
                
                <!-- Deux colonnes : Liste des invit√©s et Timeline des entr√©es -->
                <div class="grid md:grid-cols-3 gap-6 reveal">
                    <!-- Liste des invit√©s (2/3 de large) -->
                    <div class="md:col-span-2">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h4 class="heading-font text-xl font-bold mb-4 flex items-center gap-2">
                                <i class="fas fa-list gold-text"></i>
                                Liste des invit√©s
                                <span class="text-sm font-normal text-gray-400 ml-2" id="guestCount">(0 invit√©s)</span>
                            </h4>
                            
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="p-4 text-left text-sm font-semibold text-gray-600">Nom</th>
                                            <th class="p-4 text-left text-sm font-semibold text-gray-600">Pr√©nom</th>
                                            <th class="p-4 text-left text-sm font-semibold text-gray-600">Table</th>
                                            <th class="p-4 text-left text-sm font-semibold text-gray-600">Statut</th>
                                            <th class="p-4 text-left text-sm font-semibold text-gray-600">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="guestList" class="divide-y divide-gray-100"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Timeline des entr√©es (1/3 de large) - NOUVEAU -->
                    <div class="md:col-span-1">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h4 class="heading-font text-xl font-bold mb-4 flex items-center gap-2">
                                <i class="fas fa-clock gold-text"></i>
                                Derni√®res entr√©es
                            </h4>
                            
                            <div id="entryTimeline" class="entry-timeline">
                                <!-- Les entr√©es seront ajout√©es ici dynamiquement -->
                                <div class="text-center text-gray-400 py-8">
                                    <i class="fas fa-history text-3xl mb-2 opacity-50"></i>
                                    <p>Aucune entr√©e pour le moment</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Panneau d'administration (ajout d'invit√©s) -->
                <div class="mt-8 bg-gold-pale/20 rounded-2xl p-6 reveal">
                    <h4 class="heading-font text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-user-plus gold-text"></i>
                        Ajouter un nouvel invit√©
                    </h4>
                    <div class="grid md:grid-cols-3 gap-4 mb-4">
                        <input type="text" id="nomInput" placeholder="Nom" class="p-3 border border-gray-200 rounded-lg">
                        <input type="text" id="prenomInput" placeholder="Pr√©nom" class="p-3 border border-gray-200 rounded-lg">
                        <input type="number" id="tableInput" placeholder="N¬∞ Table (1-30)" class="p-3 border border-gray-200 rounded-lg" min="1" max="30">
                    </div>
                    <button id="addGuestButton" class="btn-gold px-6 py-3 rounded-lg font-semibold">
                        <i class="fas fa-check-circle mr-2"></i>
                        Enregistrer l'invit√©
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-charcoal text-white pt-16 pb-8">
        <div class="container mx-auto px-6">
            <div class="text-center">
                <p class="text-gray-400 text-sm">
                    ¬© 2025 Mariage de mon Fr√®re. Gestion des pr√©sences en temps r√©el.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // ===== DONN√âES DES INVIT√âS AVEC STATUT DE PR√âSENCE =====
        let guests = [
            { id: 1, nom: "Dupont", prenom: "Jean", table: 5, estEntr√©: false, heureEntr√©e: null },
            { id: 2, nom: "Martin", prenom: "Sophie", table: 3, estEntr√©: false, heureEntr√©e: null },
            { id: 3, nom: "Bernard", prenom: "Pierre", table: 7, estEntr√©: false, heureEntr√©e: null },
            { id: 4, nom: "Thomas", prenom: "Marie", table: 2, estEntr√©: false, heureEntr√©e: null },
            { id: 5, nom: "Robert", prenom: "Philippe", table: 8, estEntr√©: false, heureEntr√©e: null },
            { id: 6, nom: "Petit", prenom: "Isabelle", table: 4, estEntr√©: false, heureEntr√©e: null },
            { id: 7, nom: "Durand", prenom: "Claude", table: 1, estEntr√©: false, heureEntr√©e: null },
            { id: 8, nom: "Leroy", prenom: "Nathalie", table: 6, estEntr√©: false, heureEntr√©e: null },
            { id: 9, nom: "Moreau", prenom: "Alain", table: 5, estEntr√©: false, heureEntr√©e: null },
            { id: 10, nom: "Simon", prenom: "Christine", table: 3, estEntr√©: false, heureEntr√©e: null }
        ];

        // Historique des entr√©es (timeline)
        let entryHistory = [];

        // Identifiants de connexion
        const validCredentials = [
            { username: "organisateur", password: "mariage2025" },
            { username: "admin", password: "admin123" },
            { username: "potier", password: "accesinvites" },
            { username: "frere", password: "mariage21" }
        ];

        let isAuthenticated = false;

        // ===== √âL√âMENTS DOM =====
        const authModal = document.getElementById('authModal');
        const loginForm = document.getElementById('loginForm');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginError = document.getElementById('loginError');
        const errorMessageText = document.getElementById('errorMessageText');
        const cancelLoginBtn = document.getElementById('cancelLogin');
        const adminAccessBtn = document.getElementById('adminAccessBtn');
        const adminAccessBtnMobile = document.getElementById('adminAccessBtnMobile');
        const accessVerificationBtn = document.getElementById('accessVerificationBtn');
        
        const guestMessage = document.getElementById('guestMessage');
        const verificationInterface = document.getElementById('verificationInterface');
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const searchResult = document.getElementById('searchResult');
        const errorMessage = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');
        const logoutBtn = document.getElementById('logoutBtn');
        
        const nomInput = document.getElementById('nomInput');
        const prenomInput = document.getElementById('prenomInput');
        const tableInput = document.getElementById('tableInput');
        const addGuestButton = document.getElementById('addGuestButton');
        const guestList = document.getElementById('guestList');
        const entryTimeline = document.getElementById('entryTimeline');
        
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');

        // ===== FONCTIONS DE STATISTIQUES =====
        function updateStatistics() {
            const totalGuests = guests.length;
            const enteredGuests = guests.filter(g => g.estEntr√©).length;
            const pendingGuests = totalGuests - enteredGuests;
            const presenceRate = totalGuests > 0 ? Math.round((enteredGuests / totalGuests) * 100) : 0;

            document.getElementById('totalGuests').textContent = totalGuests;
            document.getElementById('enteredGuests').textContent = enteredGuests;
            document.getElementById('pendingGuests').textContent = pendingGuests;
            document.getElementById('presenceRate').textContent = presenceRate + '%';
            document.getElementById('guestCount').textContent = `(${totalGuests} invit√©s)`;
        }

        // ===== FONCTION POUR MARQUER UN INVIT√â COMME ENTR√â =====
        function marquerEntree(guestId) {
            const guest = guests.find(g => g.id === guestId);
            
            if (!guest) return false;
            
            if (guest.estEntr√©) {
                alert(`‚ùå ${guest.prenom} ${guest.nom} est d√©j√† entr√© dans la salle.`);
                return false;
            }
            
            // Marquer comme entr√©
            guest.estEntr√© = true;
            const heureEntr√©e = new Date();
            guest.heureEntr√©e = heureEntr√©e;
            
            // Ajouter √† l'historique
            const timeStr = heureEntr√©e.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            entryHistory.unshift({
                id: guest.id,
                nom: guest.nom,
                prenom: guest.prenom,
                heure: timeStr,
                timestamp: heureEntr√©e.getTime()
            });
            
            // Mettre √† jour l'affichage
            renderGuestList();
            updateStatistics();
            updateTimeline();
            
            // Afficher confirmation
            alert(`‚úÖ ${guest.prenom} ${guest.nom} est maintenant enregistr√© comme pr√©sent.`);
            
            return true;
        }

        // ===== FONCTION POUR METTRE √Ä JOUR LA TIMELINE =====
        function updateTimeline() {
            if (!entryTimeline) return;
            
            if (entryHistory.length === 0) {
                entryTimeline.innerHTML = `
                    <div class="text-center text-gray-400 py-8">
                        <i class="fas fa-history text-3xl mb-2 opacity-50"></i>
                        <p>Aucune entr√©e pour le moment</p>
                    </div>
                `;
                return;
            }
            
            let timelineHTML = '';
            entryHistory.slice(0, 10).forEach(entry => {
                timelineHTML += `
                    <div class="timeline-item">
                        <div class="flex items-center gap-2 mb-1">
                            <i class="fas fa-user-check text-green-500 text-sm"></i>
                            <span class="font-semibold">${entry.prenom} ${entry.nom}</span>
                        </div>
                        <div class="flex items-center justify-between text-xs">
                            <span class="text-gray-500">Table ${guests.find(g => g.id === entry.id)?.table || '?'}</span>
                            <span class="text-gold">${entry.heure}</span>
                        </div>
                    </div>
                `;
            });
            
            entryTimeline.innerHTML = timelineHTML;
        }

        // ===== FONCTION DE RECHERCHE AM√âLIOR√âE =====
        function searchGuest() {
            const searchTerm = searchInput.value.trim().toLowerCase();
            
            searchResult.classList.add('hidden');
            errorMessage.classList.add('hidden');
            
            if (!searchTerm) {
                showError("Veuillez entrer un nom ou pr√©nom.");
                return;
            }
            
            const foundGuest = guests.find(guest => 
                guest.nom.toLowerCase().includes(searchTerm) || 
                guest.prenom.toLowerCase().includes(searchTerm)
            );
            
            if (foundGuest) {
                displayGuestResult(foundGuest);
            } else {
                showError("Ce nom ne figure pas sur la liste des invit√©s.");
            }
        }

        // ===== AFFICHAGE DU R√âSULTAT DE RECHERCHE AVEC BOUTON D'ENTR√âE =====
        function displayGuestResult(guest) {
            const statusClass = guest.estEntr√© ? 'status-entered' : 'status-absent';
            const statusText = guest.estEntr√© ? 'D√©j√† entr√©' : 'Pas encore entr√©';
            const statusIcon = guest.estEntr√© ? 'fa-check-circle' : 'fa-hourglass-half';
            
            const resultHTML = `
                <div class="bg-white rounded-2xl p-8 shadow-lg border ${guest.estEntr√© ? 'border-blue-200' : 'border-yellow-200'}">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                        <div class="flex items-center gap-6">
                            <div class="w-20 h-20 ${guest.estEntr√© ? 'bg-blue-100' : 'bg-yellow-100'} rounded-full flex items-center justify-center">
                                <i class="fas ${guest.estEntr√© ? 'fa-check-circle text-blue-600' : 'fa-user text-yellow-600'} text-3xl"></i>
                            </div>
                            <div>
                                <h3 class="heading-font text-2xl font-bold mb-2">${guest.prenom} ${guest.nom}</h3>
                                <div class="flex items-center gap-4">
                                    <span class="status-badge ${statusClass}">
                                        <i class="fas ${statusIcon}"></i>
                                        ${statusText}
                                    </span>
                                    <span class="flex items-center gap-1 text-gold">
                                        <i class="fas fa-chair"></i>
                                        Table ${guest.table}
                                    </span>
                                </div>
                                ${guest.estEntr√© ? `
                                    <p class="text-sm text-gray-400 mt-2">
                                        Entr√© √† ${guest.heureEntr√©e ? new Date(guest.heureEntr√©e).toLocaleTimeString('fr-FR') : ''}
                                    </p>
                                ` : ''}
                            </div>
                        </div>
                        
                        ${!guest.estEntr√© ? `
                            <button onclick="marquerEntree(${guest.id})" 
                                    class="btn-gold px-8 py-4 rounded-xl font-semibold whitespace-nowrap">
                                <i class="fas fa-sign-in-alt mr-2"></i>
                                Marquer l'entr√©e
                            </button>
                        ` : `
                            <button disabled 
                                    class="px-8 py-4 bg-gray-100 text-gray-400 rounded-xl font-semibold cursor-not-allowed">
                                <i class="fas fa-check-circle mr-2"></i>
                                D√©j√† enregistr√©
                            </button>
                        `}
                    </div>
                </div>
            `;
            
            searchResult.innerHTML = resultHTML;
            searchResult.classList.remove('hidden');
        }

        // ===== AFFICHAGE DE LA LISTE DES INVIT√âS AVEC STATUTS =====
        function renderGuestList() {
            if (!guestList) return;
            
            guestList.innerHTML = '';
            
            if (guests.length === 0) {
                guestList.innerHTML = `
                    <tr>
                        <td colspan="5" class="p-8 text-center text-gray-500">
                            Aucun invit√© enregistr√©
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Trier par nom
            const sortedGuests = [...guests].sort((a, b) => a.nom.localeCompare(b.nom));
            
            sortedGuests.forEach(guest => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 transition';
                
                const statusClass = guest.estEntr√© ? 'status-present' : 'status-absent';
                const statusText = guest.estEntr√© ? 'Pr√©sent' : 'Absent';
                const statusIcon = guest.estEntr√© ? 'fa-check-circle' : 'fa-hourglass-half';
                
                row.innerHTML = `
                    <td class="p-4 font-medium">${guest.nom}</td>
                    <td class="p-4">${guest.prenom}</td>
                    <td class="p-4">
                        <span class="inline-flex items-center justify-center w-8 h-8 bg-gold-pale rounded-full text-gold font-bold text-sm">
                            ${guest.table}
                        </span>
                    </td>
                    <td class="p-4">
                        <span class="status-badge ${statusClass}">
                            <i class="fas ${statusIcon}"></i>
                            ${statusText}
                        </span>
                    </td>
                    <td class="p-4">
                        ${!guest.estEntr√© ? `
                            <button onclick="marquerEntree(${guest.id})" 
                                    class="text-green-600 hover:text-green-800 hover:bg-green-50 p-2 rounded-lg transition">
                                <i class="fas fa-sign-in-alt"></i>
                            </button>
                        ` : `
                            <span class="text-gray-400 p-2">
                                <i class="fas fa-check-circle"></i>
                            </span>
                        `}
                        <button onclick="deleteGuest(${guest.id})" 
                                class="text-red-500 hover:text-red-700 hover:bg-red-50 p-2 rounded-lg transition ml-2">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                guestList.appendChild(row);
            });
            
            updateStatistics();
            updateTimeline();
        }

        // ===== FONCTIONS D'AUTHENTIFICATION =====
        function showAuthModal() {
            authModal.classList.remove('hidden');
            usernameInput.focus();
        }

        function hideAuthModal() {
            authModal.classList.add('hidden');
            loginForm.reset();
            loginError.classList.add('hidden');
        }

        function authenticateUser() {
            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();
            
            const isValid = validCredentials.some(cred => 
                cred.username === username && cred.password === password
            );
            
            if (isValid) {
                isAuthenticated = true;
                hideAuthModal();
                showVerificationInterface();
            } else {
                loginError.classList.remove('hidden');
                errorMessageText.textContent = "Identifiants incorrects";
                passwordInput.value = '';
                passwordInput.focus();
            }
        }

        function showVerificationInterface() {
            guestMessage.classList.add('hidden');
            verificationInterface.classList.remove('hidden');
            renderGuestList();
            document.getElementById('invites').scrollIntoView({ behavior: 'smooth' });
        }

        function logout() {
            isAuthenticated = false;
            verificationInterface.classList.add('hidden');
            guestMessage.classList.remove('hidden');
            searchInput.value = '';
            searchResult.classList.add('hidden');
            errorMessage.classList.add('hidden');
        }

        function showError(message) {
            errorText.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        // ===== GESTION DES INVIT√âS (ADMIN) =====
        function addGuest() {
            const nom = nomInput.value.trim();
            const prenom = prenomInput.value.trim();
            const table = parseInt(tableInput.value);
            
            if (!nom || !prenom || !table) {
                alert("Veuillez remplir tous les champs.");
                return;
            }
            
            if (table < 1 || table > 30) {
                alert("Le num√©ro de table doit √™tre entre 1 et 30.");
                return;
            }
            
            const existingGuest = guests.find(guest => 
                guest.nom.toLowerCase() === nom.toLowerCase() && 
                guest.prenom.toLowerCase() === prenom.toLowerCase()
            );
            
            if (existingGuest) {
                alert("Cet invit√© est d√©j√† enregistr√©.");
                return;
            }
            
            const newGuest = {
                id: guests.length + 1,
                nom: nom,
                prenom: prenom,
                table: table,
                estEntr√©: false,
                heureEntr√©e: null
            };
            
            guests.push(newGuest);
            renderGuestList();
            
            nomInput.value = '';
            prenomInput.value = '';
            tableInput.value = '';
            
            alert(`‚úÖ Invit√© ${prenom} ${nom} ajout√© √† la table ${table}`);
        }

        function deleteGuest(id) {
            if (confirm("Supprimer cet invit√© de la liste ?")) {
                guests = guests.filter(guest => guest.id !== id);
                entryHistory = entryHistory.filter(entry => entry.id !== id);
                renderGuestList();
            }
        }

        // ===== ANIMATIONS AU SCROLL =====
        function revealElements() {
            const reveals = document.querySelectorAll('.reveal');
            reveals.forEach(element => {
                const windowHeight = window.innerHeight;
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < windowHeight - elementVisible) {
                    element.classList.add('active');
                }
            });
        }

        // ===== EVENT LISTENERS =====
        window.addEventListener('load', () => {
            renderGuestList();
            revealElements();
        });

        window.addEventListener('scroll', revealElements);

        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        adminAccessBtn.addEventListener('click', showAuthModal);
        adminAccessBtnMobile.addEventListener('click', showAuthModal);
        accessVerificationBtn.addEventListener('click', showAuthModal);
        cancelLoginBtn.addEventListener('click', hideAuthModal);
        
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            authenticateUser();
        });
        
        searchButton.addEventListener('click', searchGuest);
        searchInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') searchGuest();
        });
        
        logoutBtn.addEventListener('click', logout);
        addGuestButton.addEventListener('click', addGuest);

        // Rendre les fonctions accessibles globalement
        window.marquerEntree = marquerEntree;
        window.deleteGuest = deleteGuest;

        // Fermer le modal en cliquant √† l'ext√©rieur
        window.addEventListener('click', (e) => {
            if (e.target === authModal) {
                hideAuthModal();
            }
        });

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });


        // ===== FONCTIONS DE T√âL√âCHARGEMENT =====

/**
 * G√©n√®re et t√©l√©charge la liste des invit√©s au format Word
 */
function generateAndDownloadGuestList() {
    // V√©rifier si l'utilisateur est authentifi√©
    if (!isAuthenticated) {
        alert("Vous devez √™tre connect√© en tant qu'organisateur pour t√©l√©charger la liste des invit√©s.");
        showAuthModal();
        return;
    }
    
    // Compter les pr√©sents
    const totalGuests = guests.length;
    const enteredGuests = guests.filter(g => g.estEntr√©).length;
    const pendingGuests = totalGuests - enteredGuests;
    
    // Cr√©er le contenu du document Word (format HTML)
    let content = `
        <html xmlns:v="urn:schemas-microsoft-com:vml"
              xmlns:o="urn:schemas-microsoft-com:office:office"
              xmlns:w="urn:schemas-microsoft-com:office:word"
              xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
              xmlns="http://www.w3.org/TR/REC-html40">
        <head>
            <meta charset="UTF-8">
            <title>Liste des invit√©s - Mariage 22 F√©vrier 2025</title>
            <style>
                body { 
                    font-family: 'Times New Roman', serif; 
                    margin: 2cm;
                    color: #333;
                }
                h1 { 
                    color: #C5A059; 
                    text-align: center;
                    border-bottom: 2px solid #C5A059;
                    padding-bottom: 10px;
                }
                h2 { color: #2C2C2C; }
                .stats { 
                    background: #f5f5f5; 
                    padding: 15px; 
                    border-radius: 5px;
                    margin: 20px 0;
                }
                table { 
                    width: 100%; 
                    border-collapse: collapse; 
                    margin-top: 20px;
                }
                th { 
                    background: #C5A059; 
                    color: white; 
                    padding: 10px; 
                    text-align: left;
                }
                td { 
                    padding: 8px; 
                    border-bottom: 1px solid #ddd;
                }
                .present { color: green; font-weight: bold; }
                .absent { color: orange; font-weight: bold; }
                .footer { 
                    margin-top: 30px; 
                    font-style: italic;
                    text-align: center;
                    color: #666;
                }
                .table-badge {
                    background: #C5A059;
                    color: white;
                    padding: 3px 8px;
                    border-radius: 20px;
                    font-size: 12px;
                }
            </style>
        </head>
        <body>
            <h1>MARIAGE - 22 F√âVRIER 2025</h1>
            <h2 style="text-align: center;">Liste des invit√©s et gestion des pr√©sences</h2>
            
            <div class="stats">
                <h3>R√©capitulatif des pr√©sences</h3>
                <p><strong>Total invit√©s :</strong> ${totalGuests}</p>
                <p><strong>D√©j√† entr√©s :</strong> ${enteredGuests}</p>
                <p><strong>Pas encore entr√©s :</strong> ${pendingGuests}</p>
                <p><strong>Taux de pr√©sence :</strong> ${totalGuests > 0 ? Math.round((enteredGuests / totalGuests) * 100) : 0}%</p>
            </div>
            
            <h3>Liste d√©taill√©e des invit√©s</h3>
            <table>
                <thead>
                    <tr>
                        <th>N¬∞</th>
                        <th>Nom</th>
                        <th>Pr√©nom</th>
                        <th>Table</th>
                        <th>Statut</th>
                        <th>Heure d'entr√©e</th>
                    </tr>
                </thead>
                <tbody>
    `;
    
    // Ajouter chaque invit√©
    guests.sort((a, b) => a.nom.localeCompare(b.nom)).forEach((guest, index) => {
        const statusClass = guest.estEntr√© ? 'present' : 'absent';
        const statusText = guest.estEntr√© ? 'PR√âSENT' : 'ABSENT';
        const heureText = guest.estEntr√© && guest.heureEntr√©e 
            ? new Date(guest.heureEntr√©e).toLocaleTimeString('fr-FR') 
            : '-';
        
        content += `
            <tr>
                <td>${index + 1}</td>
                <td>${guest.nom}</td>
                <td>${guest.prenom}</td>
                <td><span class="table-badge">Table ${guest.table}</span></td>
                <td class="${statusClass}">${statusText}</td>
                <td>${heureText}</td>
            </tr>
        `;
    });
    
    // Ajouter un r√©capitulatif par table
    content += `
                </tbody>
            </table>
            
            <h3 style="margin-top: 30px;">R√©partition par table</h3>
    `;
    
    // Grouper par table
    const tables = {};
    guests.forEach(guest => {
        if (!tables[guest.table]) tables[guest.table] = [];
        tables[guest.table].push(guest);
    });
    
    content += '<ul>';
    for (let table = 1; table <= 30; table++) {
        if (tables[table] && tables[table].length > 0) {
            const presents = tables[table].filter(g => g.estEntr√©).length;
            content += `<li><strong>Table ${table}:</strong> ${tables[table].length} personnes (${presents} pr√©sents)</li>`;
        }
    }
    content += '</ul>';
    
    // Ajouter les derni√®res entr√©es
    if (entryHistory.length > 0) {
        content += `
            <h3 style="margin-top: 30px;">Derni√®res entr√©es enregistr√©es</h3>
            <ul>
        `;
        
        entryHistory.slice(0, 10).forEach(entry => {
            content += `<li>${entry.heure} - ${entry.prenom} ${entry.nom}</li>`;
        });
        
        content += '</ul>';
    }
    
    // Pied de page
    const now = new Date();
    const dateStr = now.toLocaleDateString('fr-FR') + ' √† ' + now.toLocaleTimeString('fr-FR');
    
    content += `
            <div class="footer">
                <p>Document g√©n√©r√© le ${dateStr}</p>
                <p>‚úß Mariage de mon Fr√®re - 22 F√©vrier 2025 ‚úß</p>
            </div>
        </body>
        </html>
    `;
    
    // Cr√©er et t√©l√©charger le fichier
    const blob = new Blob([content], { type: 'application/msword' });
    const url = window.URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `Liste_Invites_Mariage_${new Date().toISOString().split('T')[0]}.doc`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    window.URL.revokeObjectURL(url);
}

/**
 * Exporte la liste des invit√©s au format Excel (CSV)
 */
function exportToExcel() {
    if (!isAuthenticated) {
        alert("Vous devez √™tre connect√© pour exporter les donn√©es.");
        showAuthModal();
        return;
    }
    
    // Cr√©er le contenu CSV
    let csv = "Nom,Pr√©nom,Table,Statut,Heure d'entr√©e\n";
    
    guests.sort((a, b) => a.nom.localeCompare(b.nom)).forEach(guest => {
        const statut = guest.estEntr√© ? 'Pr√©sent' : 'Absent';
        const heure = guest.estEntr√© && guest.heureEntr√©e 
            ? new Date(guest.heureEntr√©e).toLocaleTimeString('fr-FR') 
            : '';
        csv += `"${guest.nom}","${guest.prenom}",${guest.table},"${statut}","${heure}"\n`;
    });
    
    // Ajouter les statistiques
    csv += '\n\nSTATISTIQUES\n';
    csv += `Total invit√©s,${guests.length}\n`;
    csv += `D√©j√† entr√©s,${guests.filter(g => g.estEntr√©).length}\n`;
    csv += `Pas encore entr√©s,${guests.filter(g => !g.estEntr√©).length}\n`;
    
    // T√©l√©charger
    const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' }); // \uFEFF pour UTF-8 avec BOM
    const url = window.URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `Liste_Invites_${new Date().toISOString().split('T')[0]}.csv`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    window.URL.revokeObjectURL(url);
}

// Ajouter l'event listener pour le bouton Excel
document.addEventListener('DOMContentLoaded', function() {
    const exportBtn = document.getElementById('exportExcelBtn');
    if (exportBtn) {
        exportBtn.addEventListener('click', exportToExcel);
    }
});
    </script>
</body>
</html>

